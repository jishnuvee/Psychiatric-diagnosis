---
title: "Predicting Psychiatric Disorders from EEG Bands"
author: "Jishnu Veerapaneni"
format: html
execute:
  echo: false
  warning: false
  message: false
---



```{r}
# Load libraries quietly
suppressPackageStartupMessages({
  library(tidyverse)
  library(ggplot2)
  library(dplyr)
  library(tidyr)
})

# Load dataset
extract_path <- "C:/Users/jishn/projects/Psychiatric-diagnosis"
file_path <- file.path(extract_path, "EEG.machinelearing_data_BRMH.csv")
x <- read.csv(file_path)


# ---------------------------
# Scatter plot: FP1 vs FP2 delta power
# ---------------------------
scatter_plot <- ggplot(x, aes(x = AB.A.delta.a.FP1, y = AB.A.delta.b.FP2, color = specific.disorder)) +
  geom_point(alpha = 0.7, size = 2) +
  theme_minimal() +
  labs(
    title = "FP1 vs FP2 Delta Power by Psychiatric Disorder",
    x = "Absolute Delta Power (FP1)",
    y = "Absolute Delta Power (FP2)",
    color = "Specific Disorder"
  ) +
  theme(plot.title = element_text(hjust = 0.5))

print(scatter_plot)


# ---------------------------
# Bar chart with error bars
# ---------------------------
summary_stats <- x %>%
  group_by(specific.disorder) %>%
  summarise(
    mean_fp1 = mean(AB.A.delta.a.FP1, na.rm = TRUE),
    mean_fp2 = mean(AB.A.delta.b.FP2, na.rm = TRUE),
    se_fp1 = sd(AB.A.delta.a.FP1, na.rm = TRUE)/sqrt(n()),
    se_fp2 = sd(AB.A.delta.b.FP2, na.rm = TRUE)/sqrt(n()),
    .groups = "drop"
  )

summary_long <- summary_stats %>%
  pivot_longer(cols = c(mean_fp1, mean_fp2, se_fp1, se_fp2),
               names_to = c(".value", "electrode"),
               names_pattern = "(mean|se)_(fp1|fp2)")

summary_plot <- ggplot(summary_long, aes(x = specific.disorder, y = mean, fill = electrode)) +
  geom_bar(stat = "identity", position = position_dodge(width = 0.8)) +
  geom_errorbar(aes(ymin = mean - 1.96*se, ymax = mean + 1.96*se),
                position = position_dodge(width = 0.8), width = 0.2) +
  theme_minimal() +
  labs(
    title = "Mean Delta Power (Â±95% CI) by Disorder",
    x = "Specific Disorder",
    y = "Mean Absolute Delta Power",
    fill = "Electrode"
  ) +
  theme(axis.text.x = element_text(angle = 45, hjust = 1),
        plot.title = element_text(hjust = 0.5))

print(summary_plot)


###



```

###

Psychiatric disorders are shaped by a wide range of neurological, cognitive, and demographic factors that can be captured through EEG data.
Using the EEG Psychiatric Disorders Dataset from Kaggle, which includes variables such as age, gender, IQ, and EEG readings, we seek to understand the relationship between brainwave activity and psychiatric conditions. The data was cleaned by filtering out incomplete records and focusing on delta power values at the FP1 and FP2 electrodes to explore patterns of neural slowing across disorders. While delta power at FP1 and FP2 electrodes are strongly correlated across disorders, individuals with schizophrenia and alcohol use disorder show unusually high delta power values suggesting that pronounced neural slowing may distinguish these conditions from others. We modeled psychiatric diagnosis as a categorical outcome using a multinomial model based on brainwave activity, age, gender, and cognitive ability. Individuals with unusually high frontal delta power were more likely to be classified with schizophrenia or alcohol use disorder.





