[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Predicting Psychiatric Disorders from EEG Bands",
    "section": "",
    "text": "Electrode locations\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nthis is for another page"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this site"
  },
  {
    "objectID": "Model.html",
    "href": "Model.html",
    "title": "Model",
    "section": "",
    "text": "This is my data generating mechanism :\nMajor Depressive Disorder vs other \\[\n\\log\\frac{P(\\text{Major Depressive Disorder})}{P(\\text{Other})} = 2.44\n- 0.064 \\times \\text{(education)}\n- 0.015 \\times \\text{(age)}\n+ 0.117 \\times \\text{(sex = female)}\n- 0.041 \\times \\text{(IQ)}\n+ 0.321 \\times \\text{(AB.A.delta.frontal)}\n\\]\nSchizophrenia vs other \\[\n\\log\\frac{P(\\text{Schizophrenia spectrum})}{P(\\text{Other})} = -1.43\n+ 0.010 \\times \\text{(education)}\n+ 0.032 \\times \\text{(age)}\n+ 0.118 \\times \\text{(sex = female)}\n- 0.003 \\times \\text{(IQ)}\n- 0.055 \\times \\text{(AB.A.delta.frontal)}\n\\]\nReference\n\\[\n\\log\\frac{P(\\text{Other})}{P(\\text{baseline})} = -1.18\n+ 0.188 \\times \\text{(education)}\n+ 0.0025 \\times \\text{(age)}\n- 1.16 \\times \\text{(sex = female)}\n+ 0.041 \\times \\text{(IQ)}\n- 0.184 \\times \\text{(AB.A.delta.frontal)}\n\\]\n\nlibrary(truncnorm)\nlibrary(nnet)\n\n\n\n#| message: false\n#| warning: false\n\n# Install and load required packages\nsuppressPackageStartupMessages(library(truncnorm))\nsuppressPackageStartupMessages(library(nnet))\n\nlibrary(tidymodels)\n\n\n# Set random seed for reproducibility\nset.seed(123)\n\n# Parameters\nn_patients &lt;- 121  # Number of unique patients\nsamples_per_patient &lt;- sample(5:10, n_patients, replace = TRUE)  # 5-10 samples per patient\nn_samples &lt;- sum(samples_per_patient)  # Total samples (~945)\n\n# Generate patient IDs\npatient_id &lt;- rep(1:n_patients, times = samples_per_patient)\n\n# Generate covariates\nsex &lt;- rbinom(n_samples, 1, 0.5)  # 0 = Male, 1 = Female\nage &lt;- rtruncnorm(n_samples, a = 18, b = Inf, mean = 35, sd = 10)\niq &lt;- rtruncnorm(n_samples, a = 49, b = Inf, mean = 100, sd = 15)\neducation &lt;- rtruncnorm(n_samples, a = 0, b = 20, mean = 14, sd = 3)\nab_a_delta_frontal &lt;- rnorm(n_samples, mean = 5, sd = 1) + \n                     rep(rnorm(n_patients, 0, 0.5), times = samples_per_patient)\n\n# Generate specific.disorder using multinomial logistic regression\n# Categories: MDD, SCZ, ANX, OTH (reference = OTH)\nbeta_0 &lt;- c(MDD = -1.5, SCZ = -2.0, ANX = -1.8)  # Intercepts\nbeta_education &lt;- c(MDD = -0.15, SCZ = -0.05, ANX = -0.10)\nbeta_age &lt;- c(MDD = 0.01, SCZ = 0.02, ANX = 0.015)\nbeta_sex &lt;- c(MDD = 0.5, SCZ = 0.3, ANX = 0.4)\nbeta_iq &lt;- c(MDD = -0.02, SCZ = -0.03, ANX = -0.015)\nbeta_eeg &lt;- c(MDD = 0.1, SCZ = 0.15, ANX = 0.05)\npatient_effect &lt;- rep(rnorm(n_patients, 0, 0.2), times = samples_per_patient)\n\n# Compute log-odds\nlogit_mdd &lt;- beta_0[\"MDD\"] + beta_education[\"MDD\"] * education + \n             beta_age[\"MDD\"] * age + beta_sex[\"MDD\"] * sex + \n             beta_iq[\"MDD\"] * iq + beta_eeg[\"MDD\"] * ab_a_delta_frontal + patient_effect\nlogit_scz &lt;- beta_0[\"SCZ\"] + beta_education[\"SCZ\"] * education + \n             beta_age[\"SCZ\"] * age + beta_sex[\"SCZ\"] * sex + \n             beta_iq[\"SCZ\"] * iq + beta_eeg[\"SCZ\"] * ab_a_delta_frontal + patient_effect\nlogit_anx &lt;- beta_0[\"ANX\"] + beta_education[\"ANX\"] * education + \n             beta_age[\"ANX\"] * age + beta_sex[\"ANX\"] * sex + \n             beta_iq[\"ANX\"] * iq + beta_eeg[\"ANX\"] * ab_a_delta_frontal + patient_effect\n\n# Compute probabilities (softmax)\nexp_mdd &lt;- exp(logit_mdd)\nexp_scz &lt;- exp(logit_scz)\nexp_anx &lt;- exp(logit_anx)\nexp_oth &lt;- 1  # Reference category\ndenom &lt;- exp_mdd + exp_scz + exp_anx + exp_oth\nprob_mdd &lt;- exp_mdd / denom\nprob_scz &lt;- exp_scz / denom\nprob_anx &lt;- exp_anx / denom\nprob_oth &lt;- exp_oth / denom\n\n# Generate specific.disorder\nspecific_disorder &lt;- sapply(1:n_samples, function(i) {\n  sample(c(\"Major Depressive Disorder\", \"Schizophrenia spectrum\", \"Anxiety\", \"Other\"),\n         size = 1, prob = c(prob_mdd[i], prob_scz[i], prob_anx[i], prob_oth[i]))\n})\n\n# Create data frame\ndf &lt;- data.frame(\n  no = patient_id,\n  sex = as.factor(sex),\n  age = age,\n  IQ = iq,\n  education = education,\n  AB.A.delta.frontal = ab_a_delta_frontal,\n  specific.disorder = as.factor(specific_disorder)\n)\n\n# Save data to CSV\nwrite.csv(df, \"simulated_eeg_data.csv\", row.names = FALSE)\n\n# Fit multinomial logistic regression model using tidymodels\nfit_disorder &lt;- multinom_reg(mode = \"classification\", engine = \"nnet\") |&gt; \n  fit(specific.disorder ~ education + age + sex + IQ + AB.A.delta.frontal, data = df)\n\n# View results with confidence intervals\ntidy(fit_disorder, conf.int = TRUE)\n\n# A tibble: 18 × 8\n   y.level         term  estimate std.error statistic p.value conf.low conf.high\n   &lt;chr&gt;           &lt;chr&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;\n 1 Major Depressi… (Int…  2.44       3.84      0.634  0.526    -5.10      9.97  \n 2 Major Depressi… educ… -0.0639     0.139    -0.460  0.645    -0.336     0.208 \n 3 Major Depressi… age   -0.0154     0.0434   -0.356  0.722    -0.101     0.0697\n 4 Major Depressi… sex1   0.117      0.840     0.139  0.889    -1.53      1.76  \n 5 Major Depressi… IQ    -0.0405     0.0262   -1.55   0.122    -0.0918    0.0109\n 6 Major Depressi… AB.A…  0.321      0.329     0.977  0.329    -0.323     0.965 \n 7 Other           (Int… -1.18       2.25     -0.522  0.601    -5.59      3.24  \n 8 Other           educ…  0.188      0.0795    2.37   0.0177    0.0327    0.344 \n 9 Other           age    0.00249    0.0245    0.102  0.919    -0.0454    0.0504\n10 Other           sex1  -1.16       0.490    -2.38   0.0174   -2.12     -0.205 \n11 Other           IQ     0.0407     0.0152    2.67   0.00755   0.0108    0.0705\n12 Other           AB.A… -0.184      0.190    -0.966  0.334    -0.557     0.189 \n13 Schizophrenia … (Int… -1.43       3.67     -0.389  0.697    -8.61      5.76  \n14 Schizophrenia … educ…  0.0101     0.132     0.0764 0.939    -0.248     0.268 \n15 Schizophrenia … age    0.0317     0.0394    0.804  0.421    -0.0456    0.109 \n16 Schizophrenia … sex1   0.118      0.825     0.143  0.886    -1.50      1.73  \n17 Schizophrenia … IQ    -0.00328    0.0247   -0.133  0.894    -0.0517    0.0451\n18 Schizophrenia … AB.A… -0.0546     0.313    -0.175  0.861    -0.668     0.558"
  }
]